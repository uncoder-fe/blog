name: deploy gh-pages

on:
  push:
    branches:
      - master

jobs:
  build:
    runs-on: macOS-latest
    env:
      GITHUB_TOKEN: ${{ secrets.COMMIT_TOKEN }}
      USER_NAME: uncoder-fe
      USER_EMAIL: uncoder-fe@fake.com
    steps:
      - name: "Checkout"
        uses: actions/checkout@v2
        with:
          token: ${{ secrets.COMMIT_TOKEN }}
          repository: uncoder-fe/blog-backup
      - name: install hugo
        run: |
          cd ..
          brew install hugo
          hugo new site myblog
          mkdir myblog/content/posts
          git init
          git submodule add https://github.com/budparr/gohugo-theme-ananke.git themes/ananke
          echo 'theme = "ananke"' >> config.toml
          mv $GITHUB_WORKSPACE myblog/content/posts
          hugo
          echo "build success"
      - name: Commit files
        run: |
          echo $GITHUB_WORKSPACE
          ls -a
          
